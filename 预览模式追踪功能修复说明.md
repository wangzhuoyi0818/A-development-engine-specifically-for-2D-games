# é¢„è§ˆæ¨¡å¼è¿½è¸ªåŠŸèƒ½ä¿®å¤è¯´æ˜

**ä¿®å¤æ—¶é—´**: 2026-01-27
**é—®é¢˜**: AI ç”Ÿæˆçš„æ•Œäººè¿½è¸ªç©å®¶ç§¯æœ¨åœ¨é¢„è§ˆæ¨¡å¼ä¸‹æ— æ³•å·¥ä½œ

## é—®é¢˜æ ¹æº

é¢„è§ˆæ¨¡å¼ä¸­è¿½è¸ªåŠŸèƒ½æ— æ³•å·¥ä½œï¼Œæ˜¯ç”±äº **GamePreviewTest.tsx ç¼ºå°‘è‡ªåŠ¨è„šæœ¬æ‰§è¡Œæœºåˆ¶**ï¼š

### æ ¸å¿ƒé—®é¢˜ï¼šGamePreviewTest ä¸è‡ªåŠ¨æ‰§è¡Œè„šæœ¬

**ç—‡çŠ¶**ï¼š
- AI ç”Ÿæˆäº†è¿½è¸ªç§¯æœ¨å¹¶æ­£ç¡®ä¿å­˜åˆ° `scripts['onGameStart']` æˆ– `scripts['onUpdate']`
- æ§åˆ¶å°æ˜¾ç¤ºå¤§é‡æ‘‡æ†æ—¥å¿—ï¼Œä½†æ²¡æœ‰ä»»ä½•è¿½è¸ªç›¸å…³æ—¥å¿—
- æ•Œäººè§’è‰²ä¸ä¼šç§»åŠ¨

**åŸå› **ï¼š
`GamePreviewTest.tsx` æ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆé¢„è§ˆï¼ŒåŸæœ¬**åªæ‰‹åŠ¨å¤„ç†ç‰¹å®šäº‹ä»¶**ï¼š
- âœ… é”®ç›˜è¾“å…¥ (onKeyDown)
- âœ… è™šæ‹Ÿæ‘‡æ† (æ‰‹åŠ¨å¤„ç†)
- âœ… ç‚¹å‡»äº‹ä»¶ (onClick)
- âŒ **ç¼ºå¤±**: åœºæ™¯åˆå§‹åŒ– (onGameStart)
- âŒ **ç¼ºå¤±**: æ¯å¸§æ›´æ–° (onUpdate)

AI ç”Ÿæˆçš„è¿½è¸ªç§¯æœ¨é€šå¸¸ä¿å­˜åœ¨ `onGameStart` æˆ– `onUpdate` è§¦å‘å™¨ä¸­ï¼Œä½† GamePreviewTest ä»æœªæ‰§è¡Œè¿™äº›è„šæœ¬ï¼

## ä¿®å¤å†…å®¹

### 1. æ·»åŠ  onGameStart è„šæœ¬æ‰§è¡Œ

**ä½ç½®**: `src/components/preview/GamePreviewTest.tsx` ç¬¬ 65-77 è¡Œ

**ä½œç”¨**: åœ¨åœºæ™¯åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰ç»„ä»¶çš„ `onGameStart` è„šæœ¬

```typescript
// æ‰§è¡Œ onGameStart è„šæœ¬ï¼ˆåœºæ™¯åˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡ï¼‰
useEffect(() => {
  if (!currentPage?.components) return;

  console.log('[GamePreviewTest] ğŸš© æ‰§è¡Œ onGameStart è„šæœ¬');

  currentPage.components.forEach(component => {
    const startBlocks = component.scripts?.onGameStart || component.scripts?.game_start;
    if (startBlocks && startBlocks.length > 0) {
      console.log(`[GamePreviewTest] ğŸ¬ æ‰§è¡Œ ${component.name} çš„ onGameStartï¼Œ${startBlocks.length} ä¸ªç§¯æœ¨`);
      executeBlocks(startBlocks, component);
    }
  });
}, [currentPage?.id]); // å½“åœºæ™¯åˆ‡æ¢æ—¶é‡æ–°æ‰§è¡Œ
```

**å…³é”®ç‰¹æ€§**ï¼š
- ä¾èµ– `currentPage?.id`ï¼Œæ¯æ¬¡åˆ‡æ¢åœºæ™¯éƒ½ä¼šé‡æ–°æ‰§è¡Œ
- å…¼å®¹ä¸¤ç§é”®åï¼š`onGameStart` å’Œ `game_start`
- è¾“å‡ºè°ƒè¯•æ—¥å¿—ï¼Œæ–¹ä¾¿ç¡®è®¤æ‰§è¡Œæƒ…å†µ

### 2. æ”¹é€ æ¸¸æˆä¸»å¾ªç¯ - æŒç»­è¿è¡Œ

**ä½ç½®**: `src/components/preview/GamePreviewTest.tsx` ç¬¬ 79-185 è¡Œ

**æ”¹åŠ¨å‰**ï¼š
```typescript
// æ¸¸æˆä¸»å¾ªç¯ - åªåœ¨éœ€è¦æ—¶è¿è¡Œ
useEffect(() => {
  // æ£€æŸ¥æ˜¯å¦éœ€è¦è¿è¡Œæ¸¸æˆå¾ªç¯
  const hasActiveInput = pressedKeys.size > 0 ||
    Object.values(joystickStates).some(state => state.active && state.distance > 0);

  if (!hasActiveInput) {
    return; // âŒ æ²¡æœ‰è¾“å…¥æ—¶ä¸å¯åŠ¨å¾ªç¯
  }

  // ...
}, [pressedKeys, currentPage, joystickStates]);
```

**æ”¹åŠ¨å**ï¼š
```typescript
// æ¸¸æˆä¸»å¾ªç¯ - æŒç»­è¿è¡Œä»¥æ”¯æŒ onUpdate å’Œè¾“å…¥å¤„ç†
useEffect(() => {
  if (!currentPage) return;

  let animationFrameId: number;
  let frameCount = 0;

  const gameLoop = () => {
    frameCount++;

    // 1. æ‰§è¡Œæ‰€æœ‰ç»„ä»¶çš„ onUpdate è„šæœ¬ï¼ˆæ¯å¸§æ‰§è¡Œï¼‰
    if (currentPage?.components) {
      currentPage.components.forEach(component => {
        const updateBlocks = component.scripts?.onUpdate || component.scripts?.game_update;
        if (updateBlocks && updateBlocks.length > 0) {
          // æ¯60å¸§ï¼ˆçº¦1ç§’ï¼‰æ‰“å°ä¸€æ¬¡æ—¥å¿—
          if (frameCount % 60 === 0) {
            console.log(`[GamePreviewTest] ğŸ”„ æ‰§è¡Œ ${component.name} çš„ onUpdateï¼Œ${updateBlocks.length} ä¸ªç§¯æœ¨`);
          }
          executeBlocks(updateBlocks, component);
        }
      });
    }

    // 2. å¤„ç†é”®ç›˜æ§åˆ¶
    // 3. å¤„ç†æ‘‡æ†æ§åˆ¶
    // ...

    animationFrameId = requestAnimationFrame(gameLoop);
  };

  animationFrameId = requestAnimationFrame(gameLoop);

  return () => {
    cancelAnimationFrame(animationFrameId);
  };
}, [pressedKeys, currentPage, joystickStates, updateComponent]);
```

**å…³é”®æ”¹è¿›**ï¼š
- âœ… æ¸¸æˆå¾ªç¯**æŒç»­è¿è¡Œ**ï¼Œä¸å†ä¾èµ–è¾“å…¥çŠ¶æ€
- âœ… æ¯å¸§è‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰ç»„ä»¶çš„ `onUpdate` è„šæœ¬
- âœ… ä½¿ç”¨ `frameCount` æ§åˆ¶æ—¥å¿—è¾“å‡ºé¢‘ç‡ï¼ˆæ¯60å¸§ä¸€æ¬¡ï¼‰
- âœ… å…¼å®¹ä¸¤ç§é”®åï¼š`onUpdate` å’Œ `game_update`

### 3. æ·»åŠ  motion_followtarget ç§¯æœ¨æ”¯æŒ

**ä½ç½®**: `src/components/preview/GamePreviewTest.tsx` ç¬¬ 267-319 è¡Œ

**ä½œç”¨**: å®ç°æ•Œäººè¿½è¸ªç©å®¶çš„è¿åŠ¨é€»è¾‘

```typescript
// å¤„ç†è·Ÿéš/è¿½è¸ªç§¯æœ¨
if (block.type === 'motion_followtarget') {
  const targetName = block.values?.target as string;
  const targetId = block.values?.targetId as string;
  const speed = (block.values?.speed as number) || 5;

  // æŸ¥æ‰¾ç›®æ ‡å¯¹è±¡
  let targetComponent: ComponentInstance | undefined;

  if (targetId) {
    targetComponent = currentPage?.components.find(c => c.id === targetId);
  } else if (targetName) {
    targetComponent = currentPage?.components.find(c => c.name === targetName);
  } else {
    // å¦‚æœæ²¡æœ‰æŒ‡å®šç›®æ ‡ï¼ŒæŸ¥æ‰¾ç¬¬ä¸€ä¸ªç©å®¶è§’è‰²
    targetComponent = currentPage?.components.find(c => c.gameRole?.roleType === 'player');
  }

  if (!targetComponent) {
    console.log(`[GamePreviewTest] âš ï¸ æœªæ‰¾åˆ°è¿½è¸ªç›®æ ‡: ${targetName || targetId || 'player'}`);
    continue;
  }

  // è®¡ç®—è¿½è¸ªç§»åŠ¨
  const dx = targetComponent.position.x - component.position.x;
  const dy = targetComponent.position.y - component.position.y;
  const distance = Math.sqrt(dx * dx + dy * dy);

  if (distance > 5) { // é¿å…æŠ–åŠ¨
    const dirX = dx / distance;
    const dirY = dy / distance;

    let newX = component.position.x + dirX * speed;
    let newY = component.position.y + dirY * speed;

    // è¾¹ç•Œé™åˆ¶
    newX = Math.max(0, Math.min(375 - component.size.width, newX));
    newY = Math.max(0, Math.min(667 - component.size.height, newY));

    updateComponent(component.id, {
      position: { x: newX, y: newY }
    });

    // æ¯60å¸§æ‰“å°ä¸€æ¬¡æ—¥å¿—ï¼ˆå‡å°‘è¾“å‡ºï¼‰
    if (Math.random() < 0.016) {
      console.log(`[GamePreviewTest] ğŸ¯ ${component.name} è¿½è¸ª ${targetComponent.name}ï¼Œè·ç¦»: ${distance.toFixed(0)}`);
    }
  }
}
```

**åŠŸèƒ½ç‰¹æ€§**ï¼š
1. **æ™ºèƒ½ç›®æ ‡æŸ¥æ‰¾**ï¼š
   - ä¼˜å…ˆä½¿ç”¨ `targetId`ï¼ˆç²¾ç¡®åŒ¹é…ï¼‰
   - å…¶æ¬¡ä½¿ç”¨ `targetName`ï¼ˆåç§°åŒ¹é…ï¼‰
   - å…œåº•æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç©å®¶è§’è‰²ï¼ˆ`gameRole.roleType === 'player'`ï¼‰

2. **å¹³æ»‘è¿½è¸ªç®—æ³•**ï¼š
   - è®¡ç®—ç›®æ ‡æ–¹å‘å‘é‡
   - æŒ‰æŒ‡å®šé€Ÿåº¦ç§»åŠ¨
   - è·ç¦»å°äº5æ—¶åœæ­¢ï¼ˆé¿å…æŠ–åŠ¨ï¼‰

3. **è¾¹ç•Œé™åˆ¶**ï¼š
   - é™åˆ¶åœ¨ç”»å¸ƒèŒƒå›´å†… (0, 0) ~ (375, 667)
   - è€ƒè™‘ç»„ä»¶è‡ªèº«å¤§å°

4. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - æ—¥å¿—è¾“å‡ºæ¦‚ç‡æ§åˆ¶ï¼ˆçº¦1/60å¸§è¾“å‡ºä¸€æ¬¡ï¼‰

### 4. å‡å°‘æ‘‡æ†æ—¥å¿—è¾“å‡º

**ä½ç½®**: `src/components/preview/GamePreviewTest.tsx` ç¬¬ 131-167 è¡Œ

**æ”¹åŠ¨**ï¼šå°†æ‘‡æ†çš„å¤§é‡æ—¥å¿—æ”¹ä¸ºæ¯60å¸§è¾“å‡ºä¸€æ¬¡ï¼Œé¿å…æ§åˆ¶å°åˆ·å±

```typescript
// å‡å°‘æ—¥å¿—è¾“å‡º
if (frameCount % 60 === 0 && state.active) {
  console.log('[GamePreviewTest] ğŸ•¹ï¸ æ‘‡æ†çŠ¶æ€:', joystickId, state);
}
```

## å·¥ä½œæµç¨‹å›¾

### ä¿®å¤å‰ï¼ˆä¸å·¥ä½œï¼‰

```
AI ç”Ÿæˆè¿½è¸ªç§¯æœ¨
  â†“
ä¿å­˜åˆ° scripts['onGameStart']  âœ…
  â†“
æ‰“å¼€é¢„è§ˆæ¨¡å¼
  â†“
GamePreviewTest å¯åŠ¨  âœ…
  â†“
åªæ‰§è¡Œé”®ç›˜/æ‘‡æ†è¾“å…¥  âŒ ä»ä¸æ‰§è¡Œ onGameStart/onUpdate
  â†“
è¿½è¸ªç§¯æœ¨ä»æœªè¢«è°ƒç”¨ â†’ æ•Œäººä¸ç§»åŠ¨
```

### ä¿®å¤åï¼ˆæ­£å¸¸å·¥ä½œï¼‰

```
AI ç”Ÿæˆè¿½è¸ªç§¯æœ¨
  â†“
ä¿å­˜åˆ° scripts['onGameStart'] æˆ– scripts['onUpdate']  âœ…
  â†“
æ‰“å¼€é¢„è§ˆæ¨¡å¼
  â†“
GamePreviewTest å¯åŠ¨  âœ…
  â†“
è‡ªåŠ¨æ‰§è¡Œ onGameStart è„šæœ¬ï¼ˆåœºæ™¯åˆå§‹åŒ–ï¼‰  âœ…
  â†“
æ¸¸æˆä¸»å¾ªç¯æŒç»­è¿è¡Œ  âœ…
  â”œâ”€ æ¯å¸§æ‰§è¡Œ onUpdate è„šæœ¬  âœ…
  â”œâ”€ æ‰§è¡Œ motion_followtarget  âœ…
  â”‚   â””â”€ è®¡ç®—æ–¹å‘ â†’ ç§»åŠ¨ç»„ä»¶  âœ…
  â”œâ”€ å¤„ç†é”®ç›˜è¾“å…¥
  â””â”€ å¤„ç†æ‘‡æ†è¾“å…¥
  â†“
æ•Œäººè¿½è¸ªç©å®¶ç§»åŠ¨ âœ…
```

## æµ‹è¯•éªŒè¯

### æµ‹è¯•ç”¨ä¾‹ 1ï¼šonGameStart ä¸­çš„è¿½è¸ª

**AI æç¤ºè¯**: "è®©åƒµå°¸è¿½è¸ªç©å®¶"

**AI ç”Ÿæˆ**ï¼ˆå¯èƒ½çš„ç»“æ„ï¼‰ï¼š
```json
[
  { "type": "event_sceneinit" },
  { "type": "logic_forever" },
  { "type": "motion_followtarget", "values": { "target": "player", "speed": 5 } }
]
```

**ä¿å­˜ä½ç½®**: `component.scripts['onGameStart']`

**é¢„è§ˆæ—¶**ï¼š
1. åœºæ™¯åŠ è½½ â†’ è§¦å‘ `onGameStart` useEffect
2. æ‰§è¡Œ `åƒµå°¸` ç»„ä»¶çš„ `onGameStart` è„šæœ¬
3. é‡åˆ° `logic_forever` â†’ å¯èƒ½éœ€è¦ç‰¹æ®Šå¤„ç†ï¼ˆTODOï¼‰
4. æ‰§è¡Œ `motion_followtarget` â†’ åƒµå°¸å¼€å§‹è¿½è¸ª

**æ§åˆ¶å°è¾“å‡º**ï¼š
```
[GamePreviewTest] ğŸš© æ‰§è¡Œ onGameStart è„šæœ¬
[GamePreviewTest] ğŸ¬ æ‰§è¡Œ åƒµå°¸ çš„ onGameStartï¼Œ3 ä¸ªç§¯æœ¨
[GamePreviewTest] ğŸ¯ åƒµå°¸ è¿½è¸ª ç©å®¶ï¼Œè·ç¦»: 150
```

### æµ‹è¯•ç”¨ä¾‹ 2ï¼šonUpdate ä¸­çš„è¿½è¸ª

**AI æç¤ºè¯**: "åƒµå°¸æ¯å¸§è¿½è¸ªç©å®¶"

**AI ç”Ÿæˆ**ï¼ˆæ”¹è¿›åçš„ç»“æ„ï¼‰ï¼š
```json
[
  { "type": "motion_followtarget", "values": { "target": "ç©å®¶", "speed": 3 } }
]
```

**ä¿å­˜ä½ç½®**: `component.scripts['onUpdate']`ï¼ˆéœ€è¦ RightSidebar æ­£ç¡®æ£€æµ‹ï¼‰

**é¢„è§ˆæ—¶**ï¼š
1. æ¸¸æˆå¾ªç¯æŒç»­è¿è¡Œ
2. æ¯å¸§æ‰§è¡Œæ‰€æœ‰ç»„ä»¶çš„ `onUpdate` è„šæœ¬
3. æ¯å¸§æ‰§è¡Œ `åƒµå°¸` çš„ `motion_followtarget`
4. åƒµå°¸æŒç»­è¿½è¸ªç©å®¶

**æ§åˆ¶å°è¾“å‡º**ï¼ˆæ¯60å¸§ä¸€æ¬¡ï¼‰ï¼š
```
[GamePreviewTest] ğŸ”„ æ‰§è¡Œ åƒµå°¸ çš„ onUpdateï¼Œ1 ä¸ªç§¯æœ¨
[GamePreviewTest] ğŸ¯ åƒµå°¸ è¿½è¸ª ç©å®¶ï¼Œè·ç¦»: 120
```

## å·²çŸ¥é™åˆ¶å’Œå¾…ä¼˜åŒ–

### 1. logic_forever ç§¯æœ¨æœªå¤„ç†

**é—®é¢˜**: AI å¯èƒ½ç”Ÿæˆ `logic_forever` åŒ…è£¹è¿½è¸ªé€»è¾‘ï¼Œä½† GamePreviewTest çš„ `executeBlocks` æ˜¯åŒæ­¥æ‰§è¡Œï¼Œæ— æ³•å®ç°çœŸæ­£çš„"æ°¸ä¹…å¾ªç¯"

**ä¸´æ—¶æ–¹æ¡ˆ**:
- å¦‚æœç§¯æœ¨åœ¨ `onGameStart` ä¸­ï¼Œ`logic_forever` åªä¼šæ‰§è¡Œä¸€æ¬¡å…¶å†…éƒ¨é€»è¾‘
- å»ºè®®å°†è¿½è¸ªé€»è¾‘æ”¾åœ¨ `onUpdate` ä¸­ï¼Œä¸éœ€è¦ `logic_forever`

**æœªæ¥ä¼˜åŒ–**:
- æ£€æµ‹ `logic_forever` å¹¶å°†å…¶å†…éƒ¨ç§¯æœ¨æå–åˆ° `onUpdate` è§¦å‘å™¨
- æˆ–è€…åœ¨ RightSidebar ä¸­æ™ºèƒ½é‡ç»„ç§¯æœ¨ç»“æ„

### 2. è§¦å‘å™¨åˆ†é…ä»å¯èƒ½é”™è¯¯

**é—®é¢˜**: å³ä½¿ GamePreviewTest æ”¯æŒ `onUpdate`ï¼ŒRightSidebar çš„ AI ç§¯æœ¨åˆ†é…é€»è¾‘å¯èƒ½ä»å°†è¿½è¸ªç§¯æœ¨åˆ†é…åˆ° `onGameStart`

**éªŒè¯æ–¹æ³•**: æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—
```
[RightSidebar] ğŸ“ ä¿å­˜åˆ° scripts["onGameStart"]ï¼Œå…± 6 ä¸ªç§¯æœ¨  // âŒ åº”è¯¥æ˜¯ onUpdate
[RightSidebar] ğŸ“ ä¿å­˜åˆ° scripts["onUpdate"]ï¼Œå…± 1 ä¸ªç§¯æœ¨   // âœ… æ­£ç¡®
```

**è§£å†³æ–¹æ¡ˆ**: å·²åœ¨ RightSidebar.tsx ä¸­æ·»åŠ æ£€æµ‹é€»è¾‘ï¼ˆè§å‰ä¸€ä¸ªä¿®å¤æ–‡æ¡£ï¼‰

### 3. æ€§èƒ½è€ƒè™‘

**ç°çŠ¶**:
- æ¸¸æˆå¾ªç¯æŒç»­è¿è¡Œï¼Œå³ä½¿æ²¡æœ‰ä»»ä½• `onUpdate` è„šæœ¬
- æ¯å¸§æ£€æŸ¥æ‰€æœ‰ç»„ä»¶

**å½±å“**:
- ç©ºåœºæ™¯æ—¶ç•¥å¾®å¢åŠ  CPU å ç”¨ï¼ˆå¯æ¥å—ï¼‰
- æœ‰å¤šä¸ªæ•Œäººæ—¶ï¼Œæ¯ä¸ªéƒ½æ‰§è¡Œè¿½è¸ªè®¡ç®—

**ä¼˜åŒ–å»ºè®®**:
- æ·»åŠ åœºæ™¯å¤æ‚åº¦æ£€æµ‹ï¼ŒåŠ¨æ€è°ƒæ•´å¸§ç‡
- å¯¹è¿œç¦»ç©å®¶çš„æ•Œäººé™ä½æ›´æ–°é¢‘ç‡

## ä½¿ç”¨æ­¥éª¤

1. **ç¡®ä¿ä»£ç å·²ä¿å­˜**ï¼ˆåº”è¯¥å·²è‡ªåŠ¨ä¿å­˜ï¼‰

2. **åˆ·æ–°æµè§ˆå™¨**
   ```
   æŒ‰ Ctrl + Shift + Rï¼ˆç¡¬åˆ·æ–°ï¼‰
   ```

3. **è®¿é—®åº”ç”¨**
   ```
   http://localhost:3007/
   ```

4. **åˆ›å»ºæˆ–é€‰æ‹©æ•Œäººè§’è‰²**
   - æ·»åŠ ä¸€ä¸ªå›¾ç‰‡ç»„ä»¶ï¼Œå‘½åä¸º"åƒµå°¸"
   - ç¡®ä¿åœºæ™¯ä¸­æœ‰ç©å®¶è§’è‰²ï¼ˆ`gameRole.roleType === 'player'`ï¼‰

5. **ä½¿ç”¨ AI ç”Ÿæˆè¿½è¸ªç§¯æœ¨**
   ```
   æç¤ºè¯: "è®©åƒµå°¸è¿½è¸ªç©å®¶"
   ```

6. **æ£€æŸ¥ç§¯æœ¨ä¿å­˜ä½ç½®**
   - æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
   - æŸ¥çœ‹æ—¥å¿—ï¼š`[RightSidebar] ğŸ“ ä¿å­˜åˆ° scripts["onGameStart"]` æˆ– `scripts["onUpdate"]`

7. **æ‰“å¼€é¢„è§ˆæ¨¡å¼**
   - ç‚¹å‡»å³ä¸Šè§’"é¢„è§ˆ"æŒ‰é’®

8. **è§‚å¯Ÿæ§åˆ¶å°å’Œæ•ˆæœ**
   - åº”è¯¥çœ‹åˆ°ï¼š`[GamePreviewTest] ğŸš© æ‰§è¡Œ onGameStart è„šæœ¬`
   - æˆ–è€…ï¼š`[GamePreviewTest] ğŸ”„ æ‰§è¡Œ åƒµå°¸ çš„ onUpdate`
   - åƒµå°¸åº”è¯¥å¼€å§‹ç§»åŠ¨å¹¶è¿½è¸ªç©å®¶ âœ…

9. **ä½¿ç”¨æ‘‡æ†æˆ– WASD æ§åˆ¶ç©å®¶**
   - åƒµå°¸åº”è¯¥è·Ÿéšç©å®¶ç§»åŠ¨

## è°ƒè¯•æŠ€å·§

### ç¡®è®¤è„šæœ¬å·²åŠ è½½

æŸ¥çœ‹æ§åˆ¶å°ï¼Œåº”è¯¥çœ‹åˆ°ç±»ä¼¼æ—¥å¿—ï¼š
```
[GamePreviewTest] ğŸš© æ‰§è¡Œ onGameStart è„šæœ¬
[GamePreviewTest] ğŸ¬ æ‰§è¡Œ åƒµå°¸ çš„ onGameStartï¼Œ3 ä¸ªç§¯æœ¨
```

å¦‚æœæ²¡æœ‰è¿™äº›æ—¥å¿—ï¼š
- æ£€æŸ¥ç»„ä»¶æ˜¯å¦æœ‰ `scripts` å­—æ®µ
- ä½¿ç”¨æµè§ˆå™¨å¼€å‘å·¥å…·æŸ¥çœ‹ç»„ä»¶æ•°æ®ï¼š`currentPage.components[0].scripts`

### ç¡®è®¤ç§¯æœ¨ç±»å‹

å¦‚æœè„šæœ¬æ‰§è¡Œäº†ä½†æ²¡æœ‰ç§»åŠ¨ï¼š
```typescript
console.log('[DEBUG] Blocks:', component.scripts?.onGameStart);
```

æŸ¥çœ‹ç§¯æœ¨ç±»å‹æ˜¯å¦åŒ…å« `motion_followtarget`

### ç¡®è®¤ç›®æ ‡è§’è‰²å­˜åœ¨

å¦‚æœæ—¥å¿—æ˜¾ç¤º"æœªæ‰¾åˆ°è¿½è¸ªç›®æ ‡"ï¼š
- ç¡®ä¿åœºæ™¯ä¸­æœ‰ç©å®¶è§’è‰²
- æ£€æŸ¥ç©å®¶çš„ `gameRole.roleType` æ˜¯å¦ä¸º `'player'`
- æˆ–è€…åœ¨ AI æç¤ºè¯ä¸­æ˜ç¡®æŒ‡å®šç›®æ ‡åç§°ï¼š"è®©åƒµå°¸è¿½è¸ªåä¸º'ä¸»è§’'çš„è§’è‰²"

---

**ä¿®å¤å®Œæˆï¼ç°åœ¨é¢„è§ˆæ¨¡å¼å¯ä»¥æ­£ç¡®æ‰§è¡Œ onGameStart å’Œ onUpdate è„šæœ¬ï¼Œæ•Œäººè¿½è¸ªåŠŸèƒ½åº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚** ğŸ¯
