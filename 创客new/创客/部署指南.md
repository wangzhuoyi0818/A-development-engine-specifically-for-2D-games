# ğŸš€ äº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## ğŸ“¦ ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡éƒ¨ç½²æ–‡ä»¶

å·²å®Œæˆï¼æ„å»ºæ–‡ä»¶åœ¨ `dist` ç›®å½•ä¸­ã€‚

## â˜ï¸ ç¬¬äºŒæ­¥ï¼šä¸Šä¼ åˆ°äº‘æœåŠ¡å™¨

### æ–¹æ¡ˆAï¼šä½¿ç”¨ WinSCP / FileZillaï¼ˆå›¾å½¢ç•Œé¢ï¼‰

1. **ä¸‹è½½å·¥å…·**
   - WinSCP: https://winscp.net/eng/download.php
   - FileZilla: https://filezilla-project.org/

2. **è¿æ¥æœåŠ¡å™¨**
   - ä¸»æœº: ä½ çš„æœåŠ¡å™¨IPåœ°å€
   - ç”¨æˆ·å: root æˆ–å…¶ä»–ç”¨æˆ·
   - å¯†ç : ä½ çš„æœåŠ¡å™¨å¯†ç 
   - ç«¯å£: 22

3. **ä¸Šä¼ æ–‡ä»¶**
   - å°†æ•´ä¸ª `dist` æ–‡ä»¶å¤¹ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ `/var/www/miniprogram` ç›®å½•

### æ–¹æ¡ˆBï¼šä½¿ç”¨å‘½ä»¤è¡Œï¼ˆéœ€è¦å…ˆå®‰è£…SSHå®¢æˆ·ç«¯ï¼‰

```bash
# å‹ç¼©distç›®å½•
cd "E:\æœ€æ–°\æœ€ç»ˆèåˆç‰ˆ_20260127\åˆ›å®¢new\åˆ›å®¢"
tar -czf dist.tar.gz dist

# ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆæ›¿æ¢YOUR_SERVER_IPï¼‰
scp dist.tar.gz root@YOUR_SERVER_IP:/root/

# SSHè¿æ¥åˆ°æœåŠ¡å™¨
ssh root@YOUR_SERVER_IP

# åœ¨æœåŠ¡å™¨ä¸Šè§£å‹
cd /var/www
tar -xzf /root/dist.tar.gz
mv dist miniprogram
```

## ğŸŒ ç¬¬ä¸‰æ­¥ï¼šé…ç½®WebæœåŠ¡å™¨

### é€‰é¡¹1ï¼šä½¿ç”¨ Nginxï¼ˆæ¨èï¼‰

#### 1. å®‰è£…Nginx

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install nginx

# CentOS/RHEL
sudo yum install nginx
```

#### 2. é…ç½®Nginx

åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š
```bash
sudo nano /etc/nginx/sites-available/miniprogram
```

ç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š
```nginx
server {
    listen 80;
    server_name your-domain.com;  # æ”¹æˆä½ çš„åŸŸåæˆ–IP

    root /var/www/miniprogram;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # å¯ç”¨gzipå‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript
               application/x-javascript application/xml+rss
               application/javascript application/json;

    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2|ttf)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

#### 3. å¯ç”¨ç«™ç‚¹

```bash
# åˆ›å»ºè½¯é“¾æ¥
sudo ln -s /etc/nginx/sites-available/miniprogram /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯Nginx
sudo systemctl restart nginx

# è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable nginx
```

### é€‰é¡¹2ï¼šä½¿ç”¨ Apache

#### 1. å®‰è£…Apache

```bash
# Ubuntu/Debian
sudo apt install apache2

# CentOS/RHEL
sudo yum install httpd
```

#### 2. é…ç½®Apache

```bash
sudo nano /etc/apache2/sites-available/miniprogram.conf
```

ç²˜è´´ï¼š
```apache
<VirtualHost *:80>
    ServerName your-domain.com
    DocumentRoot /var/www/miniprogram

    <Directory /var/www/miniprogram>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted

        # æ”¯æŒSPAè·¯ç”±
        RewriteEngine On
        RewriteBase /
        RewriteRule ^index\.html$ - [L]
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule . /index.html [L]
    </Directory>
</VirtualHost>
```

å¯ç”¨ï¼š
```bash
sudo a2ensite miniprogram
sudo a2enmod rewrite
sudo systemctl restart apache2
sudo systemctl enable apache2
```

### é€‰é¡¹3ï¼šä½¿ç”¨Node.jsé™æ€æœåŠ¡å™¨ï¼ˆæœ€ç®€å•ï¼‰

#### 1. å®‰è£…Node.js

```bash
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt install nodejs

# CentOS/RHEL
curl -fsSL https://rpm.nodesource.com/setup_20.x | sudo bash -
sudo yum install nodejs
```

#### 2. å®‰è£…serve

```bash
sudo npm install -g serve pm2
```

#### 3. å¯åŠ¨æœåŠ¡

```bash
cd /var/www/miniprogram
pm2 serve . 80 --spa --name miniprogram
pm2 save
pm2 startup
```

## ğŸ”¥ ç¬¬å››æ­¥ï¼šé…ç½®é˜²ç«å¢™

### Ubuntu/Debian (UFW)
```bash
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
```

### CentOS/RHEL (Firewalld)
```bash
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload
```

### äº‘æœåŠ¡å•†å®‰å…¨ç»„
åœ¨ä½ çš„äº‘æœåŠ¡å™¨æ§åˆ¶å°æ·»åŠ å®‰å…¨ç»„è§„åˆ™ï¼š
- å…¥ç«™è§„åˆ™ï¼šå…è®¸ TCP ç«¯å£ 80
- å…¥ç«™è§„åˆ™ï¼šå…è®¸ TCP ç«¯å£ 443ï¼ˆå¦‚æœä½¿ç”¨HTTPSï¼‰

## ğŸŒ ç¬¬äº”æ­¥ï¼šè®¿é—®ä½ çš„ç½‘ç«™

### é€šè¿‡IPè®¿é—®
```
http://ä½ çš„æœåŠ¡å™¨IP
```

### é€šè¿‡åŸŸåè®¿é—®ï¼ˆå¦‚æœæœ‰åŸŸåï¼‰

1. **æ·»åŠ DNSè®°å½•**
   - åœ¨åŸŸåæä¾›å•†å¤„æ·»åŠ  A è®°å½•
   - è®°å½•ç±»å‹: A
   - ä¸»æœºè®°å½•: @ æˆ– www
   - è®°å½•å€¼: ä½ çš„æœåŠ¡å™¨IP

2. **ç­‰å¾…DNSç”Ÿæ•ˆ**ï¼ˆé€šå¸¸5-30åˆ†é’Ÿï¼‰

3. **è®¿é—®**
   ```
   http://your-domain.com
   ```

## ğŸ”’ ç¬¬å…­æ­¥ï¼šé…ç½®HTTPSï¼ˆå¯é€‰ä½†æ¨èï¼‰

### ä½¿ç”¨Let's Encryptå…è´¹SSLè¯ä¹¦

```bash
# å®‰è£…Certbot
sudo apt install certbot python3-certbot-nginx  # Nginx
# æˆ–
sudo apt install certbot python3-certbot-apache  # Apache

# è·å–å¹¶å®‰è£…è¯ä¹¦
sudo certbot --nginx -d your-domain.com  # Nginx
# æˆ–
sudo certbot --apache -d your-domain.com  # Apache

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

## ğŸ“Š éƒ¨ç½²åæ£€æŸ¥æ¸…å•

- [ ] ç½‘ç«™å¯ä»¥é€šè¿‡IPè®¿é—®
- [ ] é¡µé¢åŠ è½½æ­£å¸¸ï¼Œæ— 404é”™è¯¯
- [ ] è™šæ‹Ÿæ‘‡æ†å’Œé”®ç›˜æ§åˆ¶æ­£å¸¸å·¥ä½œ
- [ ] åœºæ™¯åˆ‡æ¢åŠŸèƒ½æ­£å¸¸
- [ ] é™æ€èµ„æºåŠ è½½æ­£å¸¸ï¼ˆå›¾ç‰‡ã€CSSã€JSï¼‰
- [ ] ç§»åŠ¨ç«¯è®¿é—®æ­£å¸¸
- [ ] é˜²ç«å¢™å·²é…ç½®
- [ ] ï¼ˆå¯é€‰ï¼‰åŸŸåå·²è§£æ
- [ ] ï¼ˆå¯é€‰ï¼‰HTTPSå·²é…ç½®

## ğŸ› å¸¸è§é—®é¢˜

### 1. è®¿é—®404é”™è¯¯
- æ£€æŸ¥Nginx/Apacheé…ç½®ä¸­çš„ `root` è·¯å¾„æ˜¯å¦æ­£ç¡®
- ç¡®ä¿ `dist` ç›®å½•ä¸­æœ‰ `index.html`

### 2. è·¯ç”±åˆ·æ–°å404
- éœ€è¦é…ç½®SPAè·¯ç”±æ”¯æŒï¼ˆä¸Šé¢çš„é…ç½®å·²åŒ…å«ï¼‰

### 3. é™æ€èµ„æºåŠ è½½å¤±è´¥
- æ£€æŸ¥ `vite.config.ts` ä¸­çš„ `base` é…ç½®
- å¯èƒ½éœ€è¦è®¾ç½® `base: './'`

### 4. æ— æ³•è¿æ¥æœåŠ¡å™¨
- æ£€æŸ¥äº‘æœåŠ¡å•†å®‰å…¨ç»„è§„åˆ™
- æ£€æŸ¥æœåŠ¡å™¨é˜²ç«å¢™è®¾ç½®
- ç¡®è®¤WebæœåŠ¡å™¨å·²å¯åŠ¨ï¼š`sudo systemctl status nginx`

### 5. ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹å ç”¨ç«¯å£çš„è¿›ç¨‹
sudo lsof -i :80

# åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
sudo kill -9 è¿›ç¨‹ID
```

## ğŸ”„ æ›´æ–°éƒ¨ç½²

å½“ä½ ä¿®æ”¹ä»£ç åï¼Œé‡æ–°éƒ¨ç½²ï¼š

```bash
# 1. æœ¬åœ°é‡æ–°æ„å»º
npm run build

# 2. ä¸Šä¼ æ–°çš„distç›®å½•åˆ°æœåŠ¡å™¨
scp -r dist/* root@YOUR_SERVER_IP:/var/www/miniprogram/

# 3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜æˆ–å¼ºåˆ¶åˆ·æ–°ï¼ˆCtrl+Shift+Rï¼‰
```

## ğŸ“± ç§»åŠ¨ç«¯æµ‹è¯•

1. ç¡®ä¿æ‰‹æœºå’ŒæœåŠ¡å™¨åœ¨åŒä¸€ç½‘ç»œï¼ˆæˆ–ä½¿ç”¨å…¬ç½‘IPï¼‰
2. åœ¨æ‰‹æœºæµè§ˆå™¨è¾“å…¥ï¼š`http://æœåŠ¡å™¨IP`
3. æµ‹è¯•è™šæ‹Ÿæ‘‡æ†è§¦æ‘¸æ§åˆ¶

## ğŸ‰ å®Œæˆï¼

ä½ çš„æ¸¸æˆåˆ›ä½œå¹³å°ç°åœ¨å¯ä»¥é€šè¿‡äº’è”ç½‘è®¿é—®äº†ï¼

```
âœ… æœ¬åœ°å¼€å‘: http://localhost:3000
âœ… æœåŠ¡å™¨è®¿é—®: http://ä½ çš„æœåŠ¡å™¨IP
âœ… åŸŸåè®¿é—®: http://your-domain.comï¼ˆå¦‚æœå·²é…ç½®ï¼‰
```

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. æœåŠ¡å™¨æ“ä½œç³»ç»Ÿï¼ˆUbuntu/CentOS/Debianï¼‰
2. é”™è¯¯æ—¥å¿—ï¼š`sudo journalctl -u nginx -n 50`
3. æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯ï¼ˆF12ï¼‰
